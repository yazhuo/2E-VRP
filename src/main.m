%% -----------------------------信息提取程序-----------------------------clear all; close all; clc; rand('state', sum(100*clock)); format bank;%----4个文件下的测试样本数目----seq_dataset = [21,18,54,18]; %dataset文件下的4个文件Set2-Set5中测试样例数目%----参数设置----runs        = 30;                 %重复实验次数max_iter    = 500000;             %每次实验最多迭代次数500k%��文件夹内数据总量分别为：21,18,54,18; %文件夹的序号：1-4->Set2-Set5;%----Start----for num_folder = 2:2 %1:4                    %文件夹的序号：1-4分别对应文件夹Set2-Set5;    seq_data = seq_dataset(num_folder);      %第num_folder个文件夹的测试样本总数    nn = 2;                                  %set2中的第2个问题    for seq = nn:nn  %1:seq_data       %----提取文件的仓库、卫星、客户坐标、车辆信息和客户需求----        %coord_dep：仓库的坐标        %coord_sat：卫星（中转站）坐标        %coord_cus：客户的坐标        %fleet：车辆信息，fleet(1,1)为第一层车辆的最大载重量  fleet(1,2)为第一层可使用的车辆数目  fleet(2,1)为第二层车辆的最大载重量  fleet(2,2)为第二层可使用的车辆数目        %demand：客户需求        [coord_dep,coord_sat,coord_cus,fleet,demand] = extractdata(num_folder,seq);    endend% custom_num 客户的个数% sat_num 卫星的个数% m1 第一层车辆数量% m2 第二城车辆数量% K1 第一层车辆的容量% K2 第二层车辆的容量% assign_table(k,j) = 1 表示客户j被分配给卫星k% condition_record 行表示第几个卫星，custom_num = size(coord_cus,1);sat_num = size(coord_sat,1);m1 = fleet(1,2);K1 = fleet(1,1);m2 = fleet(2,2);K2 = fleet(2,1);%-------------------------------------------------------% 1. First Clustering% 将每个客户分配给一个卫星%-------------------------------------------------------DepotSatDist = calDepotSatDist(coord_dep, coord_sat, sat_num);SatCusDist = calSatCusDist(coord_sat, coord_cus, sat_num, custom_num);Cus2CusDist = calCus2CusDist(coord_cus, custom_num);assign_table = assignCus2Sat(SatCusDist, sat_num, custom_num, demand, K2, m2);%disp(assign_table);%disp(Cus2CusDist);%disp(SatCusDist);%-------------------------------------------------------% 2. GACVRP% 使用遗传算法解决Ns+1个CVRP问题%-------------------------------------------------------Route = cell(sat_num,1);RouteLength = zeros(sat_num,1);route = zeros(1,custom_num + m2);length = zeros(1,1);CustomSet = zeros(1,0);for i = 1:sat_num    %整合卫星-客户距离    temp1 = [0 SatCusDist(i,:)];    temp2 = [SatCusDist(i,:)' Cus2CusDist];    distance = [temp1;temp2];    %disp(distance(1,1));    %划分卫星客户群    for j = 1:custom_num        if assign_table(i,j) == 1            CustomSet = [CustomSet j];        end    end    %disp(CustomSet);     fprintf('\nsat %d begin cvrp...\n', i);       [best_length, best_route] = cvrp(CustomSet, demand, distance, K2);    CustomSet = zeros(1,0);        fprintf('best_length = \n');    disp(best_length);    fprintf('best_route = \n');    disp(best_route);        %Route(i,:) = route;    %RouteLenght(i,:) = length;    end